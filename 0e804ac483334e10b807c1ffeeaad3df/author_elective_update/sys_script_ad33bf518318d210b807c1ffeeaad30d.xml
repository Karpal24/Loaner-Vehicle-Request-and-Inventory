<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sys_script">
    <sys_script action="DELETE">
        <abort_action>false</abort_action>
        <access>package_private</access>
        <action_delete>false</action_delete>
        <action_insert>true</action_insert>
        <action_query>false</action_query>
        <action_update>true</action_update>
        <active>false</active>
        <add_message>false</add_message>
        <advanced>true</advanced>
        <change_fields>false</change_fields>
        <client_callable>false</client_callable>
        <collection>x_1399238_lva_vehicle_tracker</collection>
        <condition/>
        <description/>
        <execute_function>false</execute_function>
        <filter_condition table="x_1399238_lva_vehicle_tracker">vehicle_statusCHANGESTOsent_servicing^EQ<item display_value="Sent for Servicing" endquery="false" field="vehicle_status" goto="false" newquery="false" operator="CHANGESTO" or="false" value="sent_servicing"/>
            <item endquery="true" field="" goto="false" newquery="false" operator="=" or="false" value=""/>
        </filter_condition>
        <is_rest>false</is_rest>
        <message/>
        <name>Tracker set to Sent to Servicing</name>
        <order>300</order>
        <priority>100</priority>
        <rest_method/>
        <rest_method_text/>
        <rest_service/>
        <rest_service_text/>
        <rest_variables/>
        <role_conditions/>
        <script><![CDATA[(function executeRule(current, previous /*null when async*/) {

	// Add your code here

	var gr = new GlideRecord('x_1399238_lva_vehicle_servicing_t');
	
	gr.addQuery('vehicle_tracker',current.sys_id+'');
	gr.addQuery('tracker_status','open');
	gr.query();
if(!qr.next()){
	var ngr = new GlideRecord('x_1399238_lva_vehicle_servicing_t');
	var nDate = new GlideDate();
	ngr.initialize();
    ngr.setValue('vehicle_tracker', current.sys_id);
	ngr.setValue('vehicle', current.vehicle);
	ngr.setValue('vehicle_status','in_service');
	ngr.setValue('data_send_for_servicing', current.date);
	ngr.setValue('ticket_status','open');
	ngr.insert();

}
	
})(current, previous);

/*

Creating servicing ticket

Create a variable for a new GlideRecord on the servicing table
Query the servicing table for the current sys_id of the record that is 
in the vehicle tracker field
Query the servicing table for records where the tracker status is open
Execute the query
Create a “if statement”: if no matching records are found from the previous 
query move on with the script: .next()
Now you will create a couple more variables
Create a variable for a new GlideRecord on the servicing table
Create a variable for a new GlideDate that will get the current date 
( this will be used to set the current date in the servicing ticket’s
 opening date)
Initialize the creation of a new record on the servicing table using the 
GlideRecord variable you created
Populate the required fields to create the new ticket per the stories 
requirement
Set the value of vehicle tracker to the current records sys_id
Set the value of vehicle to the current records vehicle value
Set the value of vehicle status to in service
Set the value of date sent for servicing to the current date
Set the value of ticket status to open
Insert the new record
*/]]></script>
        <sys_class_name>sys_script</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2024-08-28 01:50:39</sys_created_on>
        <sys_domain>global</sys_domain>
        <sys_domain_path>/</sys_domain_path>
        <sys_id>ad33bf518318d210b807c1ffeeaad30d</sys_id>
        <sys_mod_count>24</sys_mod_count>
        <sys_name>Tracker set to Sent to Servicing</sys_name>
        <sys_overrides/>
        <sys_package display_value="Loaner Vehicle Request and Inventory" source="x_1399238_lva">0e804ac483334e10b807c1ffeeaad3df</sys_package>
        <sys_policy/>
        <sys_scope display_value="Loaner Vehicle Request and Inventory">0e804ac483334e10b807c1ffeeaad3df</sys_scope>
        <sys_update_name>sys_script_ad33bf518318d210b807c1ffeeaad30d</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2024-08-29 23:09:59</sys_updated_on>
        <template/>
        <when>before</when>
    </sys_script>
    <sys_translated_text action="DELETE" query="documentkey=ad33bf518318d210b807c1ffeeaad30d"/>
    <sys_update_version action="INSERT_OR_UPDATE">
        <action>DELETE</action>
        <application display_value="Loaner Vehicle Request and Inventory">0e804ac483334e10b807c1ffeeaad3df</application>
        <file_path/>
        <instance_id>f612c7ccdb863d14caf99027c596195a</instance_id>
        <instance_name>dev189149</instance_name>
        <name>sys_script_ad33bf518318d210b807c1ffeeaad30d</name>
        <payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update sys_domain="global" table="sys_script"&gt;&lt;sys_script action="INSERT_OR_UPDATE"&gt;&lt;abort_action&gt;false&lt;/abort_action&gt;&lt;access&gt;package_private&lt;/access&gt;&lt;action_delete&gt;false&lt;/action_delete&gt;&lt;action_insert&gt;true&lt;/action_insert&gt;&lt;action_query&gt;false&lt;/action_query&gt;&lt;action_update&gt;true&lt;/action_update&gt;&lt;active&gt;false&lt;/active&gt;&lt;add_message&gt;false&lt;/add_message&gt;&lt;advanced&gt;true&lt;/advanced&gt;&lt;change_fields&gt;false&lt;/change_fields&gt;&lt;client_callable&gt;false&lt;/client_callable&gt;&lt;collection&gt;x_1399238_lva_vehicle_tracker&lt;/collection&gt;&lt;condition/&gt;&lt;description/&gt;&lt;execute_function&gt;false&lt;/execute_function&gt;&lt;filter_condition table="x_1399238_lva_vehicle_tracker"&gt;vehicle_statusCHANGESTOsent_servicing^EQ&lt;item display_value="Sent for Servicing" endquery="false" field="vehicle_status" goto="false" newquery="false" operator="CHANGESTO" or="false" value="sent_servicing"/&gt;&lt;item endquery="true" field="" goto="false" newquery="false" operator="=" or="false" value=""/&gt;&lt;/filter_condition&gt;&lt;is_rest&gt;false&lt;/is_rest&gt;&lt;message/&gt;&lt;name&gt;Tracker set to Sent to Servicing&lt;/name&gt;&lt;order&gt;300&lt;/order&gt;&lt;priority&gt;100&lt;/priority&gt;&lt;rest_method/&gt;&lt;rest_method_text/&gt;&lt;rest_service/&gt;&lt;rest_service_text/&gt;&lt;rest_variables/&gt;&lt;role_conditions/&gt;&lt;script&gt;&lt;![CDATA[(function executeRule(current, previous /*null when async*/) {

	// Add your code here

	var gr = new GlideRecord('x_1399238_lva_vehicle_servicing_t');
	
	gr.addQuery('vehicle_tracker',current.sys_id+'');
	gr.addQuery('tracker_status','open');
	gr.query();
if(!qr.next()){
	var ngr = new GlideRecord('x_1399238_lva_vehicle_servicing_t');
	var nDate = new GlideDate();
	ngr.initialize();
    ngr.setValue('vehicle_tracker', current.sys_id);
	ngr.setValue('vehicle', current.vehicle);
	ngr.setValue('vehicle_status','in_service');
	ngr.setValue('data_send_for_servicing', current.date);
	ngr.setValue('ticket_status','open');
	ngr.insert();

}
	
})(current, previous);

/*

Creating servicing ticket

Create a variable for a new GlideRecord on the servicing table
Query the servicing table for the current sys_id of the record that is 
in the vehicle tracker field
Query the servicing table for records where the tracker status is open
Execute the query
Create a “if statement”: if no matching records are found from the previous 
query move on with the script: .next()
Now you will create a couple more variables
Create a variable for a new GlideRecord on the servicing table
Create a variable for a new GlideDate that will get the current date 
( this will be used to set the current date in the servicing ticket’s
 opening date)
Initialize the creation of a new record on the servicing table using the 
GlideRecord variable you created
Populate the required fields to create the new ticket per the stories 
requirement
Set the value of vehicle tracker to the current records sys_id
Set the value of vehicle to the current records vehicle value
Set the value of vehicle status to in service
Set the value of date sent for servicing to the current date
Set the value of ticket status to open
Insert the new record
*/]]&gt;&lt;/script&gt;&lt;sys_class_name&gt;sys_script&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2024-08-28 01:50:39&lt;/sys_created_on&gt;&lt;sys_domain&gt;global&lt;/sys_domain&gt;&lt;sys_domain_path&gt;/&lt;/sys_domain_path&gt;&lt;sys_id&gt;ad33bf518318d210b807c1ffeeaad30d&lt;/sys_id&gt;&lt;sys_mod_count&gt;24&lt;/sys_mod_count&gt;&lt;sys_name&gt;Tracker set to Sent to Servicing&lt;/sys_name&gt;&lt;sys_overrides/&gt;&lt;sys_package display_value="Loaner Vehicle Request and Inventory" source="x_1399238_lva"&gt;0e804ac483334e10b807c1ffeeaad3df&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Loaner Vehicle Request and Inventory"&gt;0e804ac483334e10b807c1ffeeaad3df&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_script_ad33bf518318d210b807c1ffeeaad30d&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2024-08-29 23:09:59&lt;/sys_updated_on&gt;&lt;template/&gt;&lt;when&gt;before&lt;/when&gt;&lt;/sys_script&gt;&lt;sys_translated_text action="delete_multiple" query="documentkey=ad33bf518318d210b807c1ffeeaad30d"/&gt;&lt;/record_update&gt;</payload>
        <payload_hash>-96236432</payload_hash>
        <record_name>Tracker set to Sent to Servicing</record_name>
        <reverted_from/>
        <source>c747a25883f78e10b807c1ffeeaad333</source>
        <source_table>sys_update_set</source_table>
        <state>previous</state>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2024-08-29 23:09:59</sys_created_on>
        <sys_id>77d1210e83109210b807c1ffeeaad363</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_recorded_at>191a06723440000001</sys_recorded_at>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2024-08-29 23:09:59</sys_updated_on>
        <type>Business Rule</type>
        <update_guid>3bd1210e44109210d82af6d3a1011762</update_guid>
        <update_guid_history>3bd1210e44109210d82af6d3a1011762:-96236432,7c90258a431092104e2e9eb87abea94f:2057594243,bd50254a8210921066706f521dc4eab3:-1278719898,1140a90a3f1092101489b75e1482b624:-1523095904,3fbf914ad1109210d396260115cfb99d:-2076686357,374f9986e2109210d080462c88fb0408:1183305433,3c0f5986d6109210f1d345db1e51dd28:-2076686357,db4dddc2661092106fcf4d61f892d7f5:1183305433,e4ccd582a7109210dc311e7ce2214045:2032025304,7d8cd1828410921036340dfbeccf2c32:-1412310808,324c59827e109210de5d9760921d2a5c:482525143,80bad18263109210e68789848920b81c:-1948127472,122a5d4251109210c0908d51b8d66058:1503397839,c91add8ee5dc5210df0b2c0914d0d637:1614579631,77f4554a35dc52101e27a331eb68387b:1226625492,7e3e60ca371c5210d6184b405a2522f2:-582241915,3125140ee29852101118b6c86ccab0ef:1645601336,68a1c9fd145812109ecfdab7bb94245a:-1460882566,cead3fa92c141210847184be7401702e:606241479,173dffad52141210e0644f2aef8485ae:406796449,613cbb6d5b1412104b321945fc6848f9:1616293316,e63bb7a9da14121016f7a1325fd7f124:-1478388031,8ee4f7259b1412108e3a3e6f0fb664df:105627513,f5647fe1d1141210c17e6aaa2213179c:-1599047716,e973fb114c18d21022badbdad571e848:2022369952</update_guid_history>
    </sys_update_version>
    <sys_metadata_delete action="INSERT_OR_UPDATE">
        <sys_audit_delete/>
        <sys_class_name>sys_metadata_delete</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2024-08-29 23:13:51</sys_created_on>
        <sys_db_object display_value="" name="sys_script">sys_script</sys_db_object>
        <sys_id>2303e57d30df49448f56d7dc50370590</sys_id>
        <sys_metadata>ad33bf518318d210b807c1ffeeaad30d</sys_metadata>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>Tracker set to Sent to Servicing</sys_name>
        <sys_package display_value="Loaner Vehicle Request and Inventory" source="x_1399238_lva">0e804ac483334e10b807c1ffeeaad3df</sys_package>
        <sys_parent display_value="Vehicle Tracker">67b20cb483b30250b807c1ffeeaad3f5</sys_parent>
        <sys_policy/>
        <sys_scope display_value="Loaner Vehicle Request and Inventory">0e804ac483334e10b807c1ffeeaad3df</sys_scope>
        <sys_scope_delete display_value="">04d10781eaea4990801aa7ab76070640</sys_scope_delete>
        <sys_update_name>sys_script_ad33bf518318d210b807c1ffeeaad30d</sys_update_name>
        <sys_update_version display_value="sys_script_ad33bf518318d210b807c1ffeeaad30d">77d1210e83109210b807c1ffeeaad363</sys_update_version>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2024-08-29 23:13:51</sys_updated_on>
    </sys_metadata_delete>
</record_update>
